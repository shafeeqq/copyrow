(function(e){function n(n,r){this.config=e.extend({},t,r);this.rowclassname="."+this.config.copyfrom;this.parentrow=this.config.parentclass;this.element=n.closest("."+this.parentrow).find(this.rowclassname).first();this.button=n;this.totalindex=e(this.rowclassname).length+1;this.getindex=e(this.button).closest("."+this.parentrow).find(">*:not(."+this.parentrow+")"+this.rowclassname).length;this.specialclass="__remove";this.init()}var t={maximum:"5",copyfrom:"row",custommessage:"Maximum Number Exceed",dynamicname:true,removeclass:"delete",parentclass:"parent"};n.prototype.getAttributes=function(t){var n={};if(t.length){e.each(t[0].attributes,function(e,t){n[t.name]=t.value})}return n};n.prototype.dynamicAttribute=function(t,n){var r=e(n).attr(t);if(r!=undefined&&r!=""){newname=e(n).attr(t)+this.totalindex;newname=newname.split("_");namelength=newname.length;if(namelength>1){newname[namelength]=String(this.getindex);newname=newname.join("_")}else{newname=e(n).attr(t)+this.totalindex+"_"+this.getindex}}return newname?newname:n};n.prototype.init=function(){var t=e(this.button).attr("class");$self=this;if(this.config.maximum>this.getindex){if(this.element.length>0){var n=this.element.clone(true,true);n.find("."+this.specialclass).remove();e("<input/>",{value:"-",type:"button","class":this.config.removeclass}).insertAfter(n.find("."+t)).addClass(this.specialclass);if(this.config.dynamicname==true){e(n).find("input[type='text'],select,checkbox").each(function(){newname=$self.dynamicAttribute("name",this);e(this).attr("name",newname);newid=$self.dynamicAttribute("id",this);e(this).attr("id",newid)})}e(n).find(this.rowclassname).each(function(){e(this).addClass($self.specialclass)});var r=this.getAttributes(n);r["html"]=n.html();var i=e("<"+e(n).get(0).tagName+"/>",r).on("click","."+this.config.removeclass,function(){e(this).closest($self.rowclassname).remove()}).addClass(this.specialclass);e(i).appendTo(e(this.button).closest("."+this.parentrow))}else return}else{alert(this.config.custommessage)}};e.fn.copyrow=function(e){new n(this,e)}})(jQuery)